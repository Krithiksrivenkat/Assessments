1)select machine_id,avg(cost) as average 
from l1_maintenance_records 
where month(maintenance_date)=3 and year(maintenance_date)=2024 
group by machine_id 
having avg(cost) > (select avg(cost) from l1_maintenance_records where month(maintenance_date)=3);

2)select maintenance_type,count(*) from l1_maintenance_records 
where month(maintenance_date)=3 and year(maintenance_date)=2024 
group by maintenance_type;

3)select technician_name,group_concat(maintenance_type),avg(cost),count(*) as maintainence_count
 from l1_maintenance_records
 where month(maintenance_date)=3 and year(maintenance_date)=2024 
 group by technician_name 
 order by avg(cost) desc limit 1 ;

4)create view reduction as
select product_id,(incident_count_pre_update-incident_count_post_update) as reduce from l2_updates;
select * from reduction;
select product_id,avg(reduce)as average from reduction
group by product_id;

5)select product_id,round(avg(user_feedback_score),1),sum(incident_count_post_update) as avg from l2_updates   
group by product_id
order by sum(incident_count_post_update) asc ;

6)select product_id,sum(reduce) from reduction group by product_id order by sum(reduce) desc limit 1;

7)select p.patient_id,v.reason_for_visit,t.outcome,v.facility_id
 from l3_patients p join l3_visits v using(patient_id) 
join l3_treatments t using(visit_id) 
where month(v.visit_date)=3 and year(v.visit_date)=2024 and 
 v.facility_id in (select facility_id from l3_visits group by facility_id having count(*) >1  );

8)select v.facility_id,v.reason_for_visit  from l3_visits v join l3_facilities f using(facility_id) where reason_for_visit="emergency" and month(v.visit_date)=3 and year(v.visit_date)=2024;

9) select p.patient_id,p.insurance_provider from l3_patients p join l3_visits v using(patient_id) 
 join l3_treatments t using(visit_id)
 where outcome="complicated" and month(v.visit_date) in (1,2,3) and year(v.visit_date)=2024;

10)select p.category,group_concat(p.product_name),sum(s.quantity*p.price) as total_sold from l4_products p join l4_sales s using(product_id) where month(s.sale_date)=3 and year(s.sale_date)=2024  group by category order by total_sold desc;

11)create view v_sale as
select * ,(p.price*s.quantity) as total from l4_sales s join l4_products p using(product_id) join l4_stores using(store_id);
select * from v_sale;
select region,sum(total) from v_sale
where month(sale_date)=3 and year(sale_date)=2024 
group by region order by sum(total) desc;

12)select s1.region,group_concat(p.product_id),count(*) from l4_products p join l4_sales s using(product_id) join l4_stores s1 using(store_id)
where month(s.sales_date)=3 and year(s.sales_date)=2024
group by s1.region
having count(*)>1;